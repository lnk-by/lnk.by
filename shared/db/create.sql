CREATE TABLE IF NOT EXISTS organization (
	id UUID PRIMARY KEY,
	name VARCHAR(255) NOT NULL,
	status VARCHAR(16) CHECK (status IN ('active', 'cancelled', 'deleted')),
	created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
	updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE TABLE IF NOT EXISTS customer (
	id UUID PRIMARY KEY,
	email VARCHAR(255) NOT NULL,
	name VARCHAR(255) NOT NULL,
    organization_id UUID REFERENCES organization(id),
	status VARCHAR(16) CHECK (status IN ('active', 'cancelled', 'deleted')),
	created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
	updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE TABLE IF NOT EXISTS campaign (
	id UUID PRIMARY KEY,
	name VARCHAR(255) NOT NULL,
    valid_from TIMESTAMPTZ NOT NULL DEFAULT now(),
    valid_until TIMESTAMPTZ NOT NULL DEFAULT '2050-01-01 00:00:00+00',
	organization_id UUID REFERENCES organization(id),
	customer_id UUID REFERENCES customer(id),
	status VARCHAR(16) CHECK (status IN ('active', 'cancelled', 'deleted')),
	created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
	updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE TABLE IF NOT EXISTS shorturl (
	key VARCHAR(32) PRIMARY KEY,
	is_custom BOOLEAN DEFAULT FALSE,
	target VARCHAR(2048) NOT NULL,
    valid_from TIMESTAMPTZ NOT NULL DEFAULT now(),
    valid_until TIMESTAMPTZ NOT NULL DEFAULT '2050-01-01 00:00:00+00',
	campaign_id UUID REFERENCES campaign(id),
	customer_id UUID REFERENCES customer(id),
	status VARCHAR(16) CHECK (status IN ('active', 'cancelled', 'deleted')),
	created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
	updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE INDEX IF NOT EXISTS idx_customer_by_organization ON customer(organization_id);

CREATE INDEX IF NOT EXISTS idx_campaign_customer ON campaign(customer_id);

CREATE INDEX IF NOT EXISTS idx_campaign_org ON campaign(organization_id);

CREATE INDEX IF NOT EXISTS idx_shorturl_customer ON shorturl(customer_id);

CREATE INDEX IF NOT EXISTS idx_shorturl_campaign ON shorturl(campaign_id);

CREATE OR REPLACE FUNCTION set_updated_at()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

DROP TRIGGER IF EXISTS set_updated_at_organization_trigger ON organization;
CREATE TRIGGER set_updated_at_organization_trigger BEFORE UPDATE ON organization FOR EACH ROW EXECUTE FUNCTION set_updated_at();


DROP TRIGGER IF EXISTS set_updated_at_customer_trigger ON customer;
CREATE TRIGGER set_updated_at_customer_trigger BEFORE UPDATE ON customer FOR EACH ROW EXECUTE FUNCTION set_updated_at();

DROP TRIGGER IF EXISTS set_updated_at_campaign_trigger ON campaign;
CREATE TRIGGER set_updated_at_campaign_trigger BEFORE UPDATE ON campaign FOR EACH ROW EXECUTE FUNCTION set_updated_at();

DROP TRIGGER IF EXISTS set_updated_at_shorturl_trigger ON shorturl;
CREATE TRIGGER set_updated_at_shorturl_trigger BEFORE UPDATE ON shorturl FOR EACH ROW EXECUTE FUNCTION set_updated_at();

-- statistics
CREATE TABLE IF NOT EXISTS total_count (
	key VARCHAR(32) PRIMARY KEY,
	total INT NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS daily_count (
    key VARCHAR(32) PRIMARY KEY,
    day001 INT NOT NULL DEFAULT 0,
    day002 INT NOT NULL DEFAULT 0,
    day003 INT NOT NULL DEFAULT 0,
    day004 INT NOT NULL DEFAULT 0,
    day005 INT NOT NULL DEFAULT 0,
    day006 INT NOT NULL DEFAULT 0,
    day007 INT NOT NULL DEFAULT 0,
    day008 INT NOT NULL DEFAULT 0,
    day009 INT NOT NULL DEFAULT 0,
    day010 INT NOT NULL DEFAULT 0,
    day011 INT NOT NULL DEFAULT 0,
    day012 INT NOT NULL DEFAULT 0,
    day013 INT NOT NULL DEFAULT 0,
    day014 INT NOT NULL DEFAULT 0,
    day015 INT NOT NULL DEFAULT 0,
    day016 INT NOT NULL DEFAULT 0,
    day017 INT NOT NULL DEFAULT 0,
    day018 INT NOT NULL DEFAULT 0,
    day019 INT NOT NULL DEFAULT 0,
    day020 INT NOT NULL DEFAULT 0,
    day021 INT NOT NULL DEFAULT 0,
    day022 INT NOT NULL DEFAULT 0,
    day023 INT NOT NULL DEFAULT 0,
    day024 INT NOT NULL DEFAULT 0,
    day025 INT NOT NULL DEFAULT 0,
    day026 INT NOT NULL DEFAULT 0,
    day027 INT NOT NULL DEFAULT 0,
    day028 INT NOT NULL DEFAULT 0,
    day029 INT NOT NULL DEFAULT 0,
    day030 INT NOT NULL DEFAULT 0,
    day031 INT NOT NULL DEFAULT 0,
    day032 INT NOT NULL DEFAULT 0,
    day033 INT NOT NULL DEFAULT 0,
    day034 INT NOT NULL DEFAULT 0,
    day035 INT NOT NULL DEFAULT 0,
    day036 INT NOT NULL DEFAULT 0,
    day037 INT NOT NULL DEFAULT 0,
    day038 INT NOT NULL DEFAULT 0,
    day039 INT NOT NULL DEFAULT 0,
    day040 INT NOT NULL DEFAULT 0,
    day041 INT NOT NULL DEFAULT 0,
    day042 INT NOT NULL DEFAULT 0,
    day043 INT NOT NULL DEFAULT 0,
    day044 INT NOT NULL DEFAULT 0,
    day045 INT NOT NULL DEFAULT 0,
    day046 INT NOT NULL DEFAULT 0,
    day047 INT NOT NULL DEFAULT 0,
    day048 INT NOT NULL DEFAULT 0,
    day049 INT NOT NULL DEFAULT 0,
    day050 INT NOT NULL DEFAULT 0,
    day051 INT NOT NULL DEFAULT 0,
    day052 INT NOT NULL DEFAULT 0,
    day053 INT NOT NULL DEFAULT 0,
    day054 INT NOT NULL DEFAULT 0,
    day055 INT NOT NULL DEFAULT 0,
    day056 INT NOT NULL DEFAULT 0,
    day057 INT NOT NULL DEFAULT 0,
    day058 INT NOT NULL DEFAULT 0,
    day059 INT NOT NULL DEFAULT 0,
    day060 INT NOT NULL DEFAULT 0,
    day061 INT NOT NULL DEFAULT 0,
    day062 INT NOT NULL DEFAULT 0,
    day063 INT NOT NULL DEFAULT 0,
    day064 INT NOT NULL DEFAULT 0,
    day065 INT NOT NULL DEFAULT 0,
    day066 INT NOT NULL DEFAULT 0,
    day067 INT NOT NULL DEFAULT 0,
    day068 INT NOT NULL DEFAULT 0,
    day069 INT NOT NULL DEFAULT 0,
    day070 INT NOT NULL DEFAULT 0,
    day071 INT NOT NULL DEFAULT 0,
    day072 INT NOT NULL DEFAULT 0,
    day073 INT NOT NULL DEFAULT 0,
    day074 INT NOT NULL DEFAULT 0,
    day075 INT NOT NULL DEFAULT 0,
    day076 INT NOT NULL DEFAULT 0,
    day077 INT NOT NULL DEFAULT 0,
    day078 INT NOT NULL DEFAULT 0,
    day079 INT NOT NULL DEFAULT 0,
    day080 INT NOT NULL DEFAULT 0,
    day081 INT NOT NULL DEFAULT 0,
    day082 INT NOT NULL DEFAULT 0,
    day083 INT NOT NULL DEFAULT 0,
    day084 INT NOT NULL DEFAULT 0,
    day085 INT NOT NULL DEFAULT 0,
    day086 INT NOT NULL DEFAULT 0,
    day087 INT NOT NULL DEFAULT 0,
    day088 INT NOT NULL DEFAULT 0,
    day089 INT NOT NULL DEFAULT 0,
    day090 INT NOT NULL DEFAULT 0,
    day091 INT NOT NULL DEFAULT 0,
    day092 INT NOT NULL DEFAULT 0,
    day093 INT NOT NULL DEFAULT 0,
    day094 INT NOT NULL DEFAULT 0,
    day095 INT NOT NULL DEFAULT 0,
    day096 INT NOT NULL DEFAULT 0,
    day097 INT NOT NULL DEFAULT 0,
    day098 INT NOT NULL DEFAULT 0,
    day099 INT NOT NULL DEFAULT 0,
    day100 INT NOT NULL DEFAULT 0,
    day101 INT NOT NULL DEFAULT 0,
    day102 INT NOT NULL DEFAULT 0,
    day103 INT NOT NULL DEFAULT 0,
    day104 INT NOT NULL DEFAULT 0,
    day105 INT NOT NULL DEFAULT 0,
    day106 INT NOT NULL DEFAULT 0,
    day107 INT NOT NULL DEFAULT 0,
    day108 INT NOT NULL DEFAULT 0,
    day109 INT NOT NULL DEFAULT 0,
    day110 INT NOT NULL DEFAULT 0,
    day111 INT NOT NULL DEFAULT 0,
    day112 INT NOT NULL DEFAULT 0,
    day113 INT NOT NULL DEFAULT 0,
    day114 INT NOT NULL DEFAULT 0,
    day115 INT NOT NULL DEFAULT 0,
    day116 INT NOT NULL DEFAULT 0,
    day117 INT NOT NULL DEFAULT 0,
    day118 INT NOT NULL DEFAULT 0,
    day119 INT NOT NULL DEFAULT 0,
    day120 INT NOT NULL DEFAULT 0,
    day121 INT NOT NULL DEFAULT 0,
    day122 INT NOT NULL DEFAULT 0,
    day123 INT NOT NULL DEFAULT 0,
    day124 INT NOT NULL DEFAULT 0,
    day125 INT NOT NULL DEFAULT 0,
    day126 INT NOT NULL DEFAULT 0,
    day127 INT NOT NULL DEFAULT 0,
    day128 INT NOT NULL DEFAULT 0,
    day129 INT NOT NULL DEFAULT 0,
    day130 INT NOT NULL DEFAULT 0,
    day131 INT NOT NULL DEFAULT 0,
    day132 INT NOT NULL DEFAULT 0,
    day133 INT NOT NULL DEFAULT 0,
    day134 INT NOT NULL DEFAULT 0,
    day135 INT NOT NULL DEFAULT 0,
    day136 INT NOT NULL DEFAULT 0,
    day137 INT NOT NULL DEFAULT 0,
    day138 INT NOT NULL DEFAULT 0,
    day139 INT NOT NULL DEFAULT 0,
    day140 INT NOT NULL DEFAULT 0,
    day141 INT NOT NULL DEFAULT 0,
    day142 INT NOT NULL DEFAULT 0,
    day143 INT NOT NULL DEFAULT 0,
    day144 INT NOT NULL DEFAULT 0,
    day145 INT NOT NULL DEFAULT 0,
    day146 INT NOT NULL DEFAULT 0,
    day147 INT NOT NULL DEFAULT 0,
    day148 INT NOT NULL DEFAULT 0,
    day149 INT NOT NULL DEFAULT 0,
    day150 INT NOT NULL DEFAULT 0,
    day151 INT NOT NULL DEFAULT 0,
    day152 INT NOT NULL DEFAULT 0,
    day153 INT NOT NULL DEFAULT 0,
    day154 INT NOT NULL DEFAULT 0,
    day155 INT NOT NULL DEFAULT 0,
    day156 INT NOT NULL DEFAULT 0,
    day157 INT NOT NULL DEFAULT 0,
    day158 INT NOT NULL DEFAULT 0,
    day159 INT NOT NULL DEFAULT 0,
    day160 INT NOT NULL DEFAULT 0,
    day161 INT NOT NULL DEFAULT 0,
    day162 INT NOT NULL DEFAULT 0,
    day163 INT NOT NULL DEFAULT 0,
    day164 INT NOT NULL DEFAULT 0,
    day165 INT NOT NULL DEFAULT 0,
    day166 INT NOT NULL DEFAULT 0,
    day167 INT NOT NULL DEFAULT 0,
    day168 INT NOT NULL DEFAULT 0,
    day169 INT NOT NULL DEFAULT 0,
    day170 INT NOT NULL DEFAULT 0,
    day171 INT NOT NULL DEFAULT 0,
    day172 INT NOT NULL DEFAULT 0,
    day173 INT NOT NULL DEFAULT 0,
    day174 INT NOT NULL DEFAULT 0,
    day175 INT NOT NULL DEFAULT 0,
    day176 INT NOT NULL DEFAULT 0,
    day177 INT NOT NULL DEFAULT 0,
    day178 INT NOT NULL DEFAULT 0,
    day179 INT NOT NULL DEFAULT 0,
    day180 INT NOT NULL DEFAULT 0,
    day181 INT NOT NULL DEFAULT 0,
    day182 INT NOT NULL DEFAULT 0,
    day183 INT NOT NULL DEFAULT 0,
    day184 INT NOT NULL DEFAULT 0,
    day185 INT NOT NULL DEFAULT 0,
    day186 INT NOT NULL DEFAULT 0,
    day187 INT NOT NULL DEFAULT 0,
    day188 INT NOT NULL DEFAULT 0,
    day189 INT NOT NULL DEFAULT 0,
    day190 INT NOT NULL DEFAULT 0,
    day191 INT NOT NULL DEFAULT 0,
    day192 INT NOT NULL DEFAULT 0,
    day193 INT NOT NULL DEFAULT 0,
    day194 INT NOT NULL DEFAULT 0,
    day195 INT NOT NULL DEFAULT 0,
    day196 INT NOT NULL DEFAULT 0,
    day197 INT NOT NULL DEFAULT 0,
    day198 INT NOT NULL DEFAULT 0,
    day199 INT NOT NULL DEFAULT 0,
    day200 INT NOT NULL DEFAULT 0,
    day201 INT NOT NULL DEFAULT 0,
    day202 INT NOT NULL DEFAULT 0,
    day203 INT NOT NULL DEFAULT 0,
    day204 INT NOT NULL DEFAULT 0,
    day205 INT NOT NULL DEFAULT 0,
    day206 INT NOT NULL DEFAULT 0,
    day207 INT NOT NULL DEFAULT 0,
    day208 INT NOT NULL DEFAULT 0,
    day209 INT NOT NULL DEFAULT 0,
    day210 INT NOT NULL DEFAULT 0,
    day211 INT NOT NULL DEFAULT 0,
    day212 INT NOT NULL DEFAULT 0,
    day213 INT NOT NULL DEFAULT 0,
    day214 INT NOT NULL DEFAULT 0,
    day215 INT NOT NULL DEFAULT 0,
    day216 INT NOT NULL DEFAULT 0,
    day217 INT NOT NULL DEFAULT 0,
    day218 INT NOT NULL DEFAULT 0,
    day219 INT NOT NULL DEFAULT 0,
    day220 INT NOT NULL DEFAULT 0,
    day221 INT NOT NULL DEFAULT 0,
    day222 INT NOT NULL DEFAULT 0,
    day223 INT NOT NULL DEFAULT 0,
    day224 INT NOT NULL DEFAULT 0,
    day225 INT NOT NULL DEFAULT 0,
    day226 INT NOT NULL DEFAULT 0,
    day227 INT NOT NULL DEFAULT 0,
    day228 INT NOT NULL DEFAULT 0,
    day229 INT NOT NULL DEFAULT 0,
    day230 INT NOT NULL DEFAULT 0,
    day231 INT NOT NULL DEFAULT 0,
    day232 INT NOT NULL DEFAULT 0,
    day233 INT NOT NULL DEFAULT 0,
    day234 INT NOT NULL DEFAULT 0,
    day235 INT NOT NULL DEFAULT 0,
    day236 INT NOT NULL DEFAULT 0,
    day237 INT NOT NULL DEFAULT 0,
    day238 INT NOT NULL DEFAULT 0,
    day239 INT NOT NULL DEFAULT 0,
    day240 INT NOT NULL DEFAULT 0,
    day241 INT NOT NULL DEFAULT 0,
    day242 INT NOT NULL DEFAULT 0,
    day243 INT NOT NULL DEFAULT 0,
    day244 INT NOT NULL DEFAULT 0,
    day245 INT NOT NULL DEFAULT 0,
    day246 INT NOT NULL DEFAULT 0,
    day247 INT NOT NULL DEFAULT 0,
    day248 INT NOT NULL DEFAULT 0,
    day249 INT NOT NULL DEFAULT 0,
    day250 INT NOT NULL DEFAULT 0,
    day251 INT NOT NULL DEFAULT 0,
    day252 INT NOT NULL DEFAULT 0,
    day253 INT NOT NULL DEFAULT 0,
    day254 INT NOT NULL DEFAULT 0,
    day255 INT NOT NULL DEFAULT 0,
    day256 INT NOT NULL DEFAULT 0,
    day257 INT NOT NULL DEFAULT 0,
    day258 INT NOT NULL DEFAULT 0,
    day259 INT NOT NULL DEFAULT 0,
    day260 INT NOT NULL DEFAULT 0,
    day261 INT NOT NULL DEFAULT 0,
    day262 INT NOT NULL DEFAULT 0,
    day263 INT NOT NULL DEFAULT 0,
    day264 INT NOT NULL DEFAULT 0,
    day265 INT NOT NULL DEFAULT 0,
    day266 INT NOT NULL DEFAULT 0,
    day267 INT NOT NULL DEFAULT 0,
    day268 INT NOT NULL DEFAULT 0,
    day269 INT NOT NULL DEFAULT 0,
    day270 INT NOT NULL DEFAULT 0,
    day271 INT NOT NULL DEFAULT 0,
    day272 INT NOT NULL DEFAULT 0,
    day273 INT NOT NULL DEFAULT 0,
    day274 INT NOT NULL DEFAULT 0,
    day275 INT NOT NULL DEFAULT 0,
    day276 INT NOT NULL DEFAULT 0,
    day277 INT NOT NULL DEFAULT 0,
    day278 INT NOT NULL DEFAULT 0,
    day279 INT NOT NULL DEFAULT 0,
    day280 INT NOT NULL DEFAULT 0,
    day281 INT NOT NULL DEFAULT 0,
    day282 INT NOT NULL DEFAULT 0,
    day283 INT NOT NULL DEFAULT 0,
    day284 INT NOT NULL DEFAULT 0,
    day285 INT NOT NULL DEFAULT 0,
    day286 INT NOT NULL DEFAULT 0,
    day287 INT NOT NULL DEFAULT 0,
    day288 INT NOT NULL DEFAULT 0,
    day289 INT NOT NULL DEFAULT 0,
    day290 INT NOT NULL DEFAULT 0,
    day291 INT NOT NULL DEFAULT 0,
    day292 INT NOT NULL DEFAULT 0,
    day293 INT NOT NULL DEFAULT 0,
    day294 INT NOT NULL DEFAULT 0,
    day295 INT NOT NULL DEFAULT 0,
    day296 INT NOT NULL DEFAULT 0,
    day297 INT NOT NULL DEFAULT 0,
    day298 INT NOT NULL DEFAULT 0,
    day299 INT NOT NULL DEFAULT 0,
    day300 INT NOT NULL DEFAULT 0,
    day301 INT NOT NULL DEFAULT 0,
    day302 INT NOT NULL DEFAULT 0,
    day303 INT NOT NULL DEFAULT 0,
    day304 INT NOT NULL DEFAULT 0,
    day305 INT NOT NULL DEFAULT 0,
    day306 INT NOT NULL DEFAULT 0,
    day307 INT NOT NULL DEFAULT 0,
    day308 INT NOT NULL DEFAULT 0,
    day309 INT NOT NULL DEFAULT 0,
    day310 INT NOT NULL DEFAULT 0,
    day311 INT NOT NULL DEFAULT 0,
    day312 INT NOT NULL DEFAULT 0,
    day313 INT NOT NULL DEFAULT 0,
    day314 INT NOT NULL DEFAULT 0,
    day315 INT NOT NULL DEFAULT 0,
    day316 INT NOT NULL DEFAULT 0,
    day317 INT NOT NULL DEFAULT 0,
    day318 INT NOT NULL DEFAULT 0,
    day319 INT NOT NULL DEFAULT 0,
    day320 INT NOT NULL DEFAULT 0,
    day321 INT NOT NULL DEFAULT 0,
    day322 INT NOT NULL DEFAULT 0,
    day323 INT NOT NULL DEFAULT 0,
    day324 INT NOT NULL DEFAULT 0,
    day325 INT NOT NULL DEFAULT 0,
    day326 INT NOT NULL DEFAULT 0,
    day327 INT NOT NULL DEFAULT 0,
    day328 INT NOT NULL DEFAULT 0,
    day329 INT NOT NULL DEFAULT 0,
    day330 INT NOT NULL DEFAULT 0,
    day331 INT NOT NULL DEFAULT 0,
    day332 INT NOT NULL DEFAULT 0,
    day333 INT NOT NULL DEFAULT 0,
    day334 INT NOT NULL DEFAULT 0,
    day335 INT NOT NULL DEFAULT 0,
    day336 INT NOT NULL DEFAULT 0,
    day337 INT NOT NULL DEFAULT 0,
    day338 INT NOT NULL DEFAULT 0,
    day339 INT NOT NULL DEFAULT 0,
    day340 INT NOT NULL DEFAULT 0,
    day341 INT NOT NULL DEFAULT 0,
    day342 INT NOT NULL DEFAULT 0,
    day343 INT NOT NULL DEFAULT 0,
    day344 INT NOT NULL DEFAULT 0,
    day345 INT NOT NULL DEFAULT 0,
    day346 INT NOT NULL DEFAULT 0,
    day347 INT NOT NULL DEFAULT 0,
    day348 INT NOT NULL DEFAULT 0,
    day349 INT NOT NULL DEFAULT 0,
    day350 INT NOT NULL DEFAULT 0,
    day351 INT NOT NULL DEFAULT 0,
    day352 INT NOT NULL DEFAULT 0,
    day353 INT NOT NULL DEFAULT 0,
    day354 INT NOT NULL DEFAULT 0,
    day355 INT NOT NULL DEFAULT 0,
    day356 INT NOT NULL DEFAULT 0,
    day357 INT NOT NULL DEFAULT 0,
    day358 INT NOT NULL DEFAULT 0,
    day359 INT NOT NULL DEFAULT 0,
    day360 INT NOT NULL DEFAULT 0,
    day361 INT NOT NULL DEFAULT 0,
    day362 INT NOT NULL DEFAULT 0,
    day363 INT NOT NULL DEFAULT 0,
    day364 INT NOT NULL DEFAULT 0,
    day365 INT NOT NULL DEFAULT 0,
    day366 INT NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS hourly_count (
    key VARCHAR(32) PRIMARY KEY,
	hour00 INT NOT NULL DEFAULT 0,
	hour01 INT NOT NULL DEFAULT 0,
	hour02 INT NOT NULL DEFAULT 0,
	hour03 INT NOT NULL DEFAULT 0,
	hour04 INT NOT NULL DEFAULT 0,
	hour05 INT NOT NULL DEFAULT 0,
	hour06 INT NOT NULL DEFAULT 0,
	hour07 INT NOT NULL DEFAULT 0,
	hour08 INT NOT NULL DEFAULT 0,
	hour09 INT NOT NULL DEFAULT 0,
	hour10 INT NOT NULL DEFAULT 0,
	hour11 INT NOT NULL DEFAULT 0,
	hour12 INT NOT NULL DEFAULT 0,
	hour13 INT NOT NULL DEFAULT 0,
	hour14 INT NOT NULL DEFAULT 0,
	hour15 INT NOT NULL DEFAULT 0,
	hour16 INT NOT NULL DEFAULT 0,
	hour17 INT NOT NULL DEFAULT 0,
	hour18 INT NOT NULL DEFAULT 0,
	hour19 INT NOT NULL DEFAULT 0,
	hour20 INT NOT NULL DEFAULT 0,
	hour21 INT NOT NULL DEFAULT 0,
	hour22 INT NOT NULL DEFAULT 0,
	hour23 INT NOT NULL DEFAULT 0,
	hour24 INT NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS useragent_count (
    key VARCHAR(32) PRIMARY KEY,

    -- Device types
    device_desktop INT NOT NULL DEFAULT 0,
    device_tablet INT NOT NULL DEFAULT 0,
    device_mobile INT NOT NULL DEFAULT 0,
    device_bot INT NOT NULL DEFAULT 0,
    device_other INT NOT NULL DEFAULT 0,

    -- Operating systems
    os_windows INT NOT NULL DEFAULT 0,
    os_linux INT NOT NULL DEFAULT 0,
    os_macos INT NOT NULL DEFAULT 0,
    os_ios INT NOT NULL DEFAULT 0,
    os_android INT NOT NULL DEFAULT 0,
    os_other INT NOT NULL DEFAULT 0,

    -- Browsers
    browser_chrome INT NOT NULL DEFAULT 0,
    browser_opera INT NOT NULL DEFAULT 0,
    browser_internet_exporer INT NOT NULL DEFAULT 0,
    browser_edge INT NOT NULL DEFAULT 0,
    browser_firefox INT NOT NULL DEFAULT 0,
    browser_other INT NOT NULL DEFAULT 0,

    -- Device + OS combinations
    desktop_windows INT NOT NULL DEFAULT 0,
    desktop_linux INT NOT NULL DEFAULT 0,
    desktop_macos INT NOT NULL DEFAULT 0,
    tablet_windows INT NOT NULL DEFAULT 0,
    tablet_linux INT NOT NULL DEFAULT 0,
    tablet_ios INT NOT NULL DEFAULT 0,
    mobile_android INT NOT NULL DEFAULT 0,
    mobile_ios INT NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS country_count (
    key VARCHAR(32) PRIMARY KEY,

    -- Country code columns with "c_" prefix
    c_AD INT NOT NULL DEFAULT 0,
    c_AE INT NOT NULL DEFAULT 0,
    c_AF INT NOT NULL DEFAULT 0,
    c_AG INT NOT NULL DEFAULT 0,
    c_AI INT NOT NULL DEFAULT 0,
    c_AL INT NOT NULL DEFAULT 0,
    c_AM INT NOT NULL DEFAULT 0,
    c_AO INT NOT NULL DEFAULT 0,
    c_AQ INT NOT NULL DEFAULT 0,
    c_AR INT NOT NULL DEFAULT 0,
    c_AS INT NOT NULL DEFAULT 0,
    c_AT INT NOT NULL DEFAULT 0,
    c_AU INT NOT NULL DEFAULT 0,
    c_AW INT NOT NULL DEFAULT 0,
    c_AX INT NOT NULL DEFAULT 0,
    c_AZ INT NOT NULL DEFAULT 0,
    c_BA INT NOT NULL DEFAULT 0,
    c_BB INT NOT NULL DEFAULT 0,
    c_BD INT NOT NULL DEFAULT 0,
    c_BE INT NOT NULL DEFAULT 0,
    c_BF INT NOT NULL DEFAULT 0,
    c_BG INT NOT NULL DEFAULT 0,
    c_BH INT NOT NULL DEFAULT 0,
    c_BI INT NOT NULL DEFAULT 0,
    c_BJ INT NOT NULL DEFAULT 0,
    c_BL INT NOT NULL DEFAULT 0,
    c_BM INT NOT NULL DEFAULT 0,
    c_BN INT NOT NULL DEFAULT 0,
    c_BO INT NOT NULL DEFAULT 0,
    c_BQ INT NOT NULL DEFAULT 0,
    c_BR INT NOT NULL DEFAULT 0,
    c_BS INT NOT NULL DEFAULT 0,
    c_BT INT NOT NULL DEFAULT 0,
    c_BV INT NOT NULL DEFAULT 0,
    c_BW INT NOT NULL DEFAULT 0,
    c_BY INT NOT NULL DEFAULT 0,
    c_BZ INT NOT NULL DEFAULT 0,
    c_CA INT NOT NULL DEFAULT 0,
    c_CC INT NOT NULL DEFAULT 0,
    c_CD INT NOT NULL DEFAULT 0,
    c_CF INT NOT NULL DEFAULT 0,
    c_CG INT NOT NULL DEFAULT 0,
    c_CH INT NOT NULL DEFAULT 0,
    c_CI INT NOT NULL DEFAULT 0,
    c_CK INT NOT NULL DEFAULT 0,
    c_CL INT NOT NULL DEFAULT 0,
    c_CM INT NOT NULL DEFAULT 0,
    c_CN INT NOT NULL DEFAULT 0,
    c_CO INT NOT NULL DEFAULT 0,
    c_CR INT NOT NULL DEFAULT 0,
    c_CU INT NOT NULL DEFAULT 0,
    c_CV INT NOT NULL DEFAULT 0,
    c_CW INT NOT NULL DEFAULT 0,
    c_CX INT NOT NULL DEFAULT 0,
    c_CY INT NOT NULL DEFAULT 0,
    c_CZ INT NOT NULL DEFAULT 0,
    c_DE INT NOT NULL DEFAULT 0,
    c_DJ INT NOT NULL DEFAULT 0,
    c_DK INT NOT NULL DEFAULT 0,
    c_DM INT NOT NULL DEFAULT 0,
    c_DO INT NOT NULL DEFAULT 0,
    c_DZ INT NOT NULL DEFAULT 0,
    c_EC INT NOT NULL DEFAULT 0,
    c_EE INT NOT NULL DEFAULT 0,
    c_EG INT NOT NULL DEFAULT 0,
    c_EH INT NOT NULL DEFAULT 0,
    c_ER INT NOT NULL DEFAULT 0,
    c_ES INT NOT NULL DEFAULT 0,
    c_ET INT NOT NULL DEFAULT 0,
    c_FI INT NOT NULL DEFAULT 0,
    c_FJ INT NOT NULL DEFAULT 0,
    c_FK INT NOT NULL DEFAULT 0,
    c_FM INT NOT NULL DEFAULT 0,
    c_FO INT NOT NULL DEFAULT 0,
    c_FR INT NOT NULL DEFAULT 0,
    c_GA INT NOT NULL DEFAULT 0,
    c_GB INT NOT NULL DEFAULT 0,
    c_GD INT NOT NULL DEFAULT 0,
    c_GE INT NOT NULL DEFAULT 0,
    c_GF INT NOT NULL DEFAULT 0,
    c_GG INT NOT NULL DEFAULT 0,
    c_GH INT NOT NULL DEFAULT 0,
    c_GI INT NOT NULL DEFAULT 0,
    c_GL INT NOT NULL DEFAULT 0,
    c_GM INT NOT NULL DEFAULT 0,
    c_GN INT NOT NULL DEFAULT 0,
    c_GP INT NOT NULL DEFAULT 0,
    c_GQ INT NOT NULL DEFAULT 0,
    c_GR INT NOT NULL DEFAULT 0,
    c_GS INT NOT NULL DEFAULT 0,
    c_GT INT NOT NULL DEFAULT 0,
    c_GU INT NOT NULL DEFAULT 0,
    c_GW INT NOT NULL DEFAULT 0,
    c_GY INT NOT NULL DEFAULT 0,
    c_HK INT NOT NULL DEFAULT 0,
    c_HM INT NOT NULL DEFAULT 0,
    c_HN INT NOT NULL DEFAULT 0,
    c_HR INT NOT NULL DEFAULT 0,
    c_HT INT NOT NULL DEFAULT 0,
    c_HU INT NOT NULL DEFAULT 0,
    c_ID INT NOT NULL DEFAULT 0,
    c_IE INT NOT NULL DEFAULT 0,
    c_IL INT NOT NULL DEFAULT 0,
    c_IM INT NOT NULL DEFAULT 0,
    c_IN INT NOT NULL DEFAULT 0,
    c_IO INT NOT NULL DEFAULT 0,
    c_IQ INT NOT NULL DEFAULT 0,
    c_IR INT NOT NULL DEFAULT 0,
    c_IS INT NOT NULL DEFAULT 0,
    c_IT INT NOT NULL DEFAULT 0,
    c_JE INT NOT NULL DEFAULT 0,
    c_JM INT NOT NULL DEFAULT 0,
    c_JO INT NOT NULL DEFAULT 0,
    c_JP INT NOT NULL DEFAULT 0,
    c_KE INT NOT NULL DEFAULT 0,
    c_KG INT NOT NULL DEFAULT 0,
    c_KH INT NOT NULL DEFAULT 0,
    c_KI INT NOT NULL DEFAULT 0,
    c_KM INT NOT NULL DEFAULT 0,
    c_KN INT NOT NULL DEFAULT 0,
    c_KP INT NOT NULL DEFAULT 0,
    c_KR INT NOT NULL DEFAULT 0,
    c_KW INT NOT NULL DEFAULT 0,
    c_KY INT NOT NULL DEFAULT 0,
    c_KZ INT NOT NULL DEFAULT 0,
    c_LA INT NOT NULL DEFAULT 0,
    c_LB INT NOT NULL DEFAULT 0,
    c_LC INT NOT NULL DEFAULT 0,
    c_LI INT NOT NULL DEFAULT 0,
    c_LK INT NOT NULL DEFAULT 0,
    c_LR INT NOT NULL DEFAULT 0,
    c_LS INT NOT NULL DEFAULT 0,
    c_LT INT NOT NULL DEFAULT 0,
    c_LU INT NOT NULL DEFAULT 0,
    c_LV INT NOT NULL DEFAULT 0,
    c_LY INT NOT NULL DEFAULT 0,
    c_MA INT NOT NULL DEFAULT 0,
    c_MC INT NOT NULL DEFAULT 0,
    c_MD INT NOT NULL DEFAULT 0,
    c_ME INT NOT NULL DEFAULT 0,
    c_MF INT NOT NULL DEFAULT 0,
    c_MG INT NOT NULL DEFAULT 0,
    c_MH INT NOT NULL DEFAULT 0,
    c_MK INT NOT NULL DEFAULT 0,
    c_ML INT NOT NULL DEFAULT 0,
    c_MM INT NOT NULL DEFAULT 0,
    c_MN INT NOT NULL DEFAULT 0,
    c_MO INT NOT NULL DEFAULT 0,
    c_MP INT NOT NULL DEFAULT 0,
    c_MQ INT NOT NULL DEFAULT 0,
    c_MR INT NOT NULL DEFAULT 0,
    c_MS INT NOT NULL DEFAULT 0,
    c_MT INT NOT NULL DEFAULT 0,
    c_MU INT NOT NULL DEFAULT 0,
    c_MV INT NOT NULL DEFAULT 0,
    c_MW INT NOT NULL DEFAULT 0,
    c_MX INT NOT NULL DEFAULT 0,
    c_MY INT NOT NULL DEFAULT 0,
    c_MZ INT NOT NULL DEFAULT 0,
    c_NA INT NOT NULL DEFAULT 0,
    c_NC INT NOT NULL DEFAULT 0,
    c_NE INT NOT NULL DEFAULT 0,
    c_NF INT NOT NULL DEFAULT 0,
    c_NG INT NOT NULL DEFAULT 0,
    c_NI INT NOT NULL DEFAULT 0,
    c_NL INT NOT NULL DEFAULT 0,
    c_NO INT NOT NULL DEFAULT 0,
    c_NP INT NOT NULL DEFAULT 0,
    c_NR INT NOT NULL DEFAULT 0,
    c_NU INT NOT NULL DEFAULT 0,
    c_NZ INT NOT NULL DEFAULT 0,
    c_OM INT NOT NULL DEFAULT 0,
    c_PA INT NOT NULL DEFAULT 0,
    c_PE INT NOT NULL DEFAULT 0,
    c_PF INT NOT NULL DEFAULT 0,
    c_PG INT NOT NULL DEFAULT 0,
    c_PH INT NOT NULL DEFAULT 0,
    c_PK INT NOT NULL DEFAULT 0,
    c_PL INT NOT NULL DEFAULT 0,
    c_PM INT NOT NULL DEFAULT 0,
    c_PN INT NOT NULL DEFAULT 0,
    c_PR INT NOT NULL DEFAULT 0,
    c_PS INT NOT NULL DEFAULT 0,
    c_PT INT NOT NULL DEFAULT 0,
    c_PW INT NOT NULL DEFAULT 0,
    c_PY INT NOT NULL DEFAULT 0,
    c_QA INT NOT NULL DEFAULT 0,
    c_RE INT NOT NULL DEFAULT 0,
    c_RO INT NOT NULL DEFAULT 0,
    c_RS INT NOT NULL DEFAULT 0,
    c_RU INT NOT NULL DEFAULT 0,
    c_RW INT NOT NULL DEFAULT 0,
    c_SA INT NOT NULL DEFAULT 0,
    c_SB INT NOT NULL DEFAULT 0,
    c_SC INT NOT NULL DEFAULT 0,
    c_SD INT NOT NULL DEFAULT 0,
    c_SE INT NOT NULL DEFAULT 0,
    c_SG INT NOT NULL DEFAULT 0,
    c_SH INT NOT NULL DEFAULT 0,
    c_SI INT NOT NULL DEFAULT 0,
    c_SJ INT NOT NULL DEFAULT 0,
    c_SK INT NOT NULL DEFAULT 0,
    c_SL INT NOT NULL DEFAULT 0,
    c_SM INT NOT NULL DEFAULT 0,
    c_SN INT NOT NULL DEFAULT 0,
    c_SO INT NOT NULL DEFAULT 0,
    c_SR INT NOT NULL DEFAULT 0,
    c_SS INT NOT NULL DEFAULT 0,
    c_ST INT NOT NULL DEFAULT 0,
    c_SV INT NOT NULL DEFAULT 0,
    c_SX INT NOT NULL DEFAULT 0,
    c_SY INT NOT NULL DEFAULT 0,
    c_SZ INT NOT NULL DEFAULT 0,
    c_TC INT NOT NULL DEFAULT 0,
    c_TD INT NOT NULL DEFAULT 0,
    c_TF INT NOT NULL DEFAULT 0,
    c_TG INT NOT NULL DEFAULT 0,
    c_TH INT NOT NULL DEFAULT 0,
    c_TJ INT NOT NULL DEFAULT 0,
    c_TK INT NOT NULL DEFAULT 0,
    c_TL INT NOT NULL DEFAULT 0,
    c_TM INT NOT NULL DEFAULT 0,
    c_TN INT NOT NULL DEFAULT 0,
    c_TO INT NOT NULL DEFAULT 0,
    c_TR INT NOT NULL DEFAULT 0,
    c_TT INT NOT NULL DEFAULT 0,
    c_TV INT NOT NULL DEFAULT 0,
    c_TW INT NOT NULL DEFAULT 0,
    c_TZ INT NOT NULL DEFAULT 0,
    c_UA INT NOT NULL DEFAULT 0,
    c_UG INT NOT NULL DEFAULT 0,
    c_UM INT NOT NULL DEFAULT 0,
    c_US INT NOT NULL DEFAULT 0,
    c_UY INT NOT NULL DEFAULT 0,
    c_UZ INT NOT NULL DEFAULT 0,
    c_VA INT NOT NULL DEFAULT 0,
    c_VC INT NOT NULL DEFAULT 0,
    c_VE INT NOT NULL DEFAULT 0,
    c_VG INT NOT NULL DEFAULT 0,
    c_VI INT NOT NULL DEFAULT 0,
    c_VN INT NOT NULL DEFAULT 0,
    c_VU INT NOT NULL DEFAULT 0,
    c_WF INT NOT NULL DEFAULT 0,
    c_WS INT NOT NULL DEFAULT 0,
    c_YE INT NOT NULL DEFAULT 0,
    c_YT INT NOT NULL DEFAULT 0,
    c_ZA INT NOT NULL DEFAULT 0,
    c_ZM INT NOT NULL DEFAULT 0,
    c_ZW INT NOT NULL DEFAULT 0,

    -- Fallback for unknown country
    c_UNKNOWN INT NOT NULL DEFAULT 0
);
